\documentclass{amsart} 
\include{macros}
\newcommand{\n}{\mathfrak{n}}
\newcommand{\cN}{\mathcal{N}}

\title{Elliptic Curves over $\Q(\sqrt{5})$}

\author[Bober et al.]{Jon Bober, Alyson Deines, Joanna Gaski, Ari Klages-Mundt, Ben
  Leveque, Andrew Ohana, Ashwath Rabindranath, Paul Sharaba, William
  Stein}

\begin{document}

\begin{abstract} 
\end{abstract} 

\maketitle

\footnote{TODO: Acknowledge NFS.  Also, always keep in mind that the
  Page limit for ANTS is 15 pages, including references.}

\section{Introduction}\label{sec:intro}

\subsection{Elliptic Curves over $\Q$}
Tables of elliptic curves over $\Q$ have been of great value in
mathematical research.  The first systematic published tables were in
Antwerp IV \cite{antwerpiv}, which included all elliptic curves over
$\Q$ of conductor up to $200$, and also a table of all elliptic curves
with bad reduction only at $2,3$.

Cremona wrote \cite{cremona:algs}, which gave a careful and
detailed description of algorithms that together would
output a list of all elliptic curves over $\Q$ of any specific 
conductor, along with extensive data about each curve.  The proof that
his algorithm output all curves of given conductor had to wait for
\cite{breuil-conrad-diamond-taylor}.  Cremona has subsequently
computed tables \cite{cremona:onlinetables} of all elliptic curves
over $\Q$ of conductor up to $210,\!000$, including Mordell-Weil groups and
extensive other data about each curve; his main current target is to reach
conductor $234,\!446$, which is the smallest known conductor of a 
rank $4$ curve.

In a different direction, Stein-Watkins (see
\cite{stein-watkins:ants5, bmsw:bulletins}) created a table of
136,832,795 elliptic curves over $\Q$ of conductor $\leq 10^8$, and
another table of 11,378,911 elliptic curves over $\Q$ of prime
conductor $\leq 10^{10}$.  For each curve, these tables contain 
a numerical approximation to $\ord_{s=1} L(E,s)$, and some other
data, though the actual ranks of all of these curves has not been
determined.  There are also many curves of large discriminant missing
from the Stein-Watkins tables, since these tables are made by
enumerating curves with relatively small defining equations, and
discarding those of large conductor, rather than systematically
finding all curves of given conductor no matter how large the defining
equation.

{\bf Acknowledgements.} John Cremona, Tom Fisher, Noam Elkies, Richard Taylor.
 
\subsection{Why $\Q(\sqrt{5})$?}

Like $\Q$, the field $F=\Q(\sqrt{5})$ is a totally real field, and
many of the techniques that we have for studying elliptic curves over
$\Q$ generalize, or are conjectured to generalize, to totally real
fields.
As is the case over $\Q$, there is a 
notion of modularity coming from Shimura curve
parametrizations and Hilbert modular forms, which is supported by
theoretical evidence \cite{}.%something suggested by R. Taylor
Moreover,  work \cite{zhang:heightsshimura} of Zhang has extended many results
of Gross-Zagier \cite{gross-zagier} and Kolyvagin \cite{kolyvagin:mordellweil} 
to the context of elliptic curves over totally real fields.

If we order fields by absolute discriminant, then $F=\Q(\sqrt{5})$ is
the next field after $\Q$.  That $5$ divides $\disc(F)=5$ obstructs
attempts to generalize the Taylor-Wiles method to elliptic curves over
$F$, which makes this case even more interesting.  The field $F$ also
has $xx$ CM $j$-invariants, which is more than any other field of
degree $\leq 2$ [[??]] (see Section~\ref{sec:cm}).  Let
$\vphi=\frac{1+\sqrt{5}}{2}$.  The unit group $\{\pm 1\} \times
\langle \vphi \rangle$ of the ring $R=\cO_F=\Z[\vphi]$ of integers of
$F$ is infinite, which leads to additional interesting complications.
Finally, the totally real field $F$ has even degree $2$, which makes
computation of Hilbert modular forms and corresponding elliptic curves
more difficult, since the cohomological techniques of \cite{} are not
available.  


\subsection{Modularity conjecture}\label{sec:mod}
The following conjecture is not yet known in general. 
\begin{conjecture}[Modularity]\label{conj:mod}
  The set of $L$-functions of elliptic curves over $F$ equals the set
  of $L$-functions associated to cuspidal Hilbert modular newforms
  over $F$ of weight $(2,2)$ with rational Hecke eigenvalues.
\end{conjecture}
Given the huge amount of recent progress on modularity theorems, we
are optimistic that Conjecture~\ref{conj:mod} will be proved.  {\em We thus
officially assume Conjecture~\ref{conj:mod}  for the rest of this paper.}


\section{Computing Hilbert modular forms over $F$}\label{sec:hmf}

We describe..., with improvements
that make it faster.   [[write outline]]

\subsection{Hilbert modular forms and quaternion 
algebras}\label{sec:dembele}
In this section, we give Dembele's algebraic approach
\cite{dembele:hilbert5} via the Jacquet-Langlands correspondence to
computing  certain Hilbert modular forms.

The Hamiltonian quaternion algebra $F[i,j,k]$ over $F$ is ramified
only at the two infinite places, and contains the maximal order
$$
 S = R\left[\frac{1}{2}(1-\overline{\vphi} i + \vphi j),\,
       \frac{1}{2}(-\overline{\vphi} i + j + \vphi k),\,
       \frac{1}{2}(\vphi i - \overline{\vphi} j + k), \,
       \frac{1}{2}(i + \vphi j - \overline{\vphi} k)\right].
$$
Let $\P^1(R/\n)$ be the set of equivalence classes of column vectors
with two coprime entries $a,b \in R/\n$ modulo the action of $R^*$.
The algebra $F[i,j,k]$ is unramified at all finite primes; in
particular, for each prime $\p\mid \n$, we may fix an isomorphism
$F[i,j,k]\tensor F_{\p} \isom M_2(F_{\p})$, which induces a left
action of $S^*$ on $\P^1(R/\n)$.
The Jaquet-Langlands correspondence implies that
the space of Hilbert modular forms with level a nonzero ideal
$\n \subset R$ and weight $(2,2)$ is
noncanonically isomorphic as a module over the Hecke algebra
$$\T=\Z[T_\p :  \p \text{ nonzero prime ideal of }R]$$ 
to the finite dimensional complex vector space $ V = \C[S^* \backslash
\P^1(R/\n)].  $ The action of $T_{\p}$, for $p\nmid \n$, is
$T_{\p}([x]) = \sum [\alpha x]$, where the sum is over the classes
$[\alpha]\in S/S^*$ with $\N(\alpha)=\pi_p$ (reduced quaternion norm),
where $\pi_p$ is a totally positive generator of~$\p$.

\subsection{An Algorithm}

In this section we describe some important details that must be
understood in order to obtain an efficient algorithm from the
isomorphism of Section~\ref{sec:dembele}.

\subsubsection{Computing $R/\n$}
Crucial to computing $\P^1(R/\n)$ efficiently is that we can compute
with $R/\n$ quickly.  To this end, we factor $\n = \prod_{i=1}^m
\p_i^{e_i}$ and represent elements of $R/\n$ as $m$-tuples in
$\bigoplus R/\p_i^{e_i}$, thus reducing to the prime power case.  To
avoid dynamic memory allocation (thus speeding up the code by an order
of magnitude), we assume that $N(\n)\leq 2^{31}$ is small enough that
any linear algebra we will do later with the corresponding module will
be feasible; we thus assume $m\leq 16$ and all $p_i^{e_i}\leq 2^{31}$,
where $p_i$ is the characteristic of $\p_i$.  As we will explain
below, we represent an element of $R/\p_i^{e_i}$ as a pair of 64-bit
integers, and represent an element of $R/\n$ as an array of 16 pairs
of 64-bit integers (we use this representation in all cases; in
particular, even if $\n$ is divisible by less than $16$ primes; the
massive speed gain coming from avoiding dynamic memory allocation more
than compensates for the wasted memory).

Let $\p^e$ be one of the prime power factors of $\n$, and let $p$ be the residue
characteristic of $\p$. We have one of the following cases:
\begin{itemize}
\item $\p$ splits in $R$; then $R/\p\isom \Z/p\Z$ and we represent elements
of $R/\p^e$ as pairs $(a,0)$ mod $p^e$ with the usual addition and multiplication
in the first factor.
\item $\p$ is inert in $R$; then $R/\p^e\isom (\Z/p^e\Z)[x]/(x^2-x-1)$,
and we represent elements by pairs $(a,b) \in \Z/p^e\Z$ with multiplication
$$(a,b)(c,d) = (ac+bd,ad+bd+bc) \mod p^e.$$
\item $\p$ is ramified and $e=2f$ is even; this is exactly the
same as the case when $\p$ is inert but with $e$ replaced by $f$,
since $R/\p^eR \isom (\Z/p^{f}\Z)[x]/(x^2-x-1)$.
\item $\p$ is ramified (so $p=5$) and $e=2f-1$ is odd; this ring $A=R/\p^e$
  is trickier than the rest, because it is {\em not} of the form
  $\Z[x]/(m,g)$ where $m\in\Z$ and $g \in\Z[x]$.  We have $A \ncisom
  (\Z/5^f\Z)[x]/(x^2-5, 5^{f-1}x)$, and represent elements of $A$ as
  pairs $(a,b) \in (\Z/5^f)\times (\Z/5^{f-1}\Z)$, with arithmetic
  given by
\begin{align*}
(a,b) + (c,d) &= (a+c \mod 5^f,\,\,\, b+d \mod 5^{f-1})\\
(a,b)\cdot (c,d) &= (ac+5bd \mod 5^f,\,\,\, ad+bc \mod 5^{f-1}).
\end{align*}
The golden ratio in $R$ maps to $(1/2,1/2)$.
\end{itemize}


\subsubsection{Computing $\P^1(R/\n)$}
We use the bijection $\P^1(\R/\n) \isom \prod_{\p_i^{e_i}}
\P^1(R/\p_i^{e_i})$ to reduce to the prime power case.  Each element
$[(a,b)]$ of $\P^1(R/\p_i^{e_i})$ has a unique representative of the
form $(1,b)$ or $(a,1)$ with $a$ divisible by $\p$, so it is straightforward
to enumerate the elements of $\P^1(R/\p_i^{e_i})$ after choosing a way
to enumerate the elements of $R/\p_i^{e_i}$.  Also, we put an element
of $\P^1(\R/\n)$ in the above canonical form by working with each factor
individually. 


\subsubsection{Enumerating elements of $S$ of norm $\pi_p$ modulo $S^*$}
[[TODO!]]
This is around line 1099 of sqrt5.py.  It was pretty tricky to figure out
and involves multiple ideas.

\subsubsection{Computing a local splitting}
[[TODO!]]



\section{Strategies for finding an elliptic curve attached to a Hilbert modular form}\label{sec:finding}
Let $f\in S_{(2,2)}(\n)$ be a rational Hilbert newforms as in
Section~\ref{sec:hmf}.  According to Conjecture~\ref{conj:mod}, there
is some elliptic curve $E_f$ over $f$ such that $L(f,s) = L(E_f,s)$.
Note that $E_f$ is only well defined up to isogeny.  Unlike the case
for elliptic curves over $\Q$ (see \cite{cremona:algs}), there appears
to be no fast direct algorithm to find $E_f$.  Nonetheless, there are
numerous approaches.

In all the sections below, we assume that Conjecture~\ref{conj:mod} is
true and that we have computed (as in Section~\ref{sec:hmf}) a
complete list of Hecke eigenvalues $a_\p$ of all rational Hilbert
newforms of some level $\n$, to at least enough precision $B$ to determine
one from another.

\subsection{Naive enumeration}\label{sec:naive}

The most naive strategy is to systematically enumerate pairs $a,b\in
R$, hence elliptic curves $E: y^2 = x^3 + ax + b$ over $F$, and for
each curve compute some $L$-series coefficients $a_\p(E)$ at primes
that do not divide the discriminant of the cubic by counting points
modulo primes.  If all $a_\p(E)$ match with those of the input newform
$f$, up to the bound $B$, we then compute the conductor $\cN_E$, and
if it equals $\n$, we conclude that $L(E_f,s) = L(f,s)$.

Under our hypotheses, naive enumeration is an algorithm to solve our
problem: it will terminate, and when it terminates it outputs a
correct curve $E_f$. Unfortunately, it can be very slow because even
if $\n$ is small, the simplest curve in the isogeny class of $E_f$ may
have very large coefficients, for example, if each is of the form
$x+\vphi y$ with $x$ and $y$ having coefficients around $10^5$, then
we would have to consider $10^{20}$ before finding $E_f$, which is not
feasible.

\subsection{Torsion families}\label{sec:torsion}

We can tell whether or not $\ell\mid \#E(F)_{\tor}$ for some
$E$ in the isogeny class of $E_f$ using the following proposition.

\begin{proposition}
 TODO: Explain how to tell if $\ell\mid \#E(F)_{\tor}$.
\end{proposition}
\begin{proof}
  Use Galois representations, and also Katz's theorem.
\end{proof}

Instead of searching through all curves as in Section~\ref{sec:naive},
...


\subsection{Twisting}

\subsection{Curves with specified $a_\p$}

\subsection{Curves with good reduction outside $S$}

\subsection{Special values of twisted $L$-series}

\subsection{Congruence families}



\section{Enumerating the curves in an isogeny class}\label{sec:isoclass}

Given an elliptic curve $E/F$, we wish to find representative
isomorphism classes for all elliptic curves $E'/F$ that are isogenous
to $E$ via an isogeny defined over $F$.  The analogue of this problem
over $\Q$ has an algorithmic solution as explained in
\cite[\S3.8]{cremona:algs}; it relies on (1) Mazur's theorem
\cite{mazur:rational} that $\deg(E\to E')\leq 163$, and (2) formulas
of Velu \cite{velu:isogenies} that provide a way to explicitly
enumerate all $p$-isogenies with domain $E$.  Velu's formulas are
valid for any number field, but so far there has not been an explicit
generalization of Mazur's theorem for any number field other than
$\Q$.  In this connection, see \cite{} ((work of Dmitry Vayntrob and
Eric Larson)), which asserts that the set isogeny degrees over a
number field $K$ is {\em finite} when a certain obvious CM obstruction
is not present.  [[Remove the last sentence if we can't find a solid 
reference; maybe it was wrong and evaporated, as big theorems are
apt to do.]]

Fortunately, \cite{billerey:isog} sidesteps this issue with an
algorithm that takes as input a specific non-CM elliptic $E$ over a
number field $K$, and outputs a finite list of primes $p$ such that
$E$ might have a $p$-isogeny.  The algorithm is particularly easy to
implement in the special case when $K$ is a quadratic field, as
explained in \cite[\S2.3.4]{billerey:isog}.  Using this algorithm
combined with Velu's formulas, we were easily able to enumerate {\em
  all} isomorphism classes of curves isogenous to the curves we found
via the methods of Section~\ref{sec:finding}, and divide our curves up into
isogeny classes.


\section{Related future projects}\label{sec:future}

It would be natural to extend the tables to the first known curve of
rank $3$, which may be the known one of norm conductor $163^2=26569$.
It would also be interesting to make a table in the style of
\cite{stein-watkins:ants5}, and compute analytic ranks of the large
number of curves that we would find; this would benefit from
Sutherland's smalljac program, which has very fast code for computing
$L$-series coefficients.  Some aspects of the tables could also be
generalized to modular abelian varieties $A_f$ attached to Hilbert
modular newforms with not-necessarily-rational Hecke eigenvalues; in
particular, we could enumerate the $A_f$ up to some norm conductor,
and numerically compute their analytic ranks.

\section{Tables}\label{sec:tables}

As explained in Sections~\ref{sec:finding} and \ref{sec:isoclass},
assuming Conjecture~\ref{conj:mod}, we found the complete list of
elliptic curves with norm conductor up to $1831$, which is the first
norm conductor of a rank $2$ curve over $F$.  Table~\ref{table:counts}
summarizes the number of curves we found.  Note that in these counts
we do not exclude conjugate curves, i.e., if $\sigma$ denotes the
nontrivial element of $\Gal(F/\Q)$, then we count $E$ and $E^{\sigma}$
separately if they are not isomorphic.  For comparison, 
there are 5260 isogeny classes and 10283 isomorphism classes
of elliptic curves over $\Q$ with conductor up to $1831$ [[double check!]].
\begin{center}
\begin{table}[h]
\caption{Curves over $\Q(\sqrt{5})$\label{table:counts}}
\begin{tabular}{|c|c|c|c|}\hline
rank & $\#\{\text{ isogeny classes }\}$ &  $\#\{\text{ isom. classes }\}$ & smallest norm conductor\\\hline
 $0$ & $750$ & ? & 31\\\hline
 $1$ & $650$ & ? & 199\\\hline
 $2$ & $2$ & ?  & 1831\\\hline
total & $1402$ & $3338$ & - \\\hline
\end{tabular}
\end{table}
\end{center}

\subsection{Up to norm conductor  $199$}\label{sec:to199}

[[TODO: This will be a short-as-reasonable table of curves of norm
conductor $\leq 199$, hence including the first curve of rank $1$.  It
will probably be about 6 pages long.]]

\subsection{CM elliptic curves over $F$}\label{sec:cm}

[[TODO: A table like in the back of \cite{silverman:aec2}, but over
$\Q(\sqrt{5})$.  We haven't made this yet.  I'm not sure how hard this
is; should be fun.]]

\subsection{Extended version only: up to norm conductor  $1831$}\label{sec:to1831}

[[This will contain a longer version, which includes both curves and
their conjugates, etc., and has all data up to 1831, and will be over
100 pages long.  This will be a special version only available on our
websites; we won't submit this to a journal.]]



\bibliographystyle{amsalpha} 
\bibliography{biblio}
\end{document}
